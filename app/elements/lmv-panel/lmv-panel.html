<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="lmv-panel">

  <!-- CSS Rules -->
  <link rel="import" type="css" href="lmv-panel.css">

  <!-- Local DOM -->
  <template>
    <div id="header" on-track="_handleDrag">
      <span class="title">{{title}}</span>
      <iron-icon class="icon" icon="expand-more" on-tap="toggleCollapse"></iron-icon>
      <iron-icon class="icon" icon="close" on-tap="close"></iron-icon>
    </div>
    <div id="content">
      <content></content>
    </div>
  </template>

</dom-module>

<!-- Polymer Script -->
<script>
(function() {
  Polymer({
    is: "lmv-panel",

    properties: {
      title: {
        type: String,
        value: "Title",
        reflectToAttribute: true,
      },
      collapse: {
        type: Boolean,
        value: false,
        reflectToAttribute: true,
      },
      _dragged: {
        type: Boolean,
        value: false,
        reflectToAttribute: true,
      },
    },

    toggleCollapse: function() {
      this.collapse = !this.collapse;
    },

    close: function() {
      Polymer.dom(this.parentNode).removeChild(this);
    },

    _handleDrag: function(e) {
      switch(e.detail.state) {
        case "start":
          var rect = this.getBoundingClientRect();
          this._dragged = true;
          this._top = rect.top;
          this._left = rect.left;
          break;
        case "track":
          this._top += e.detail.ddy;
          this._left += e.detail.ddx;
          this.style.top = this._top + "px";
          this.style.left = this._left + "px";
          break;
      }
    },

  });
})();
</script>